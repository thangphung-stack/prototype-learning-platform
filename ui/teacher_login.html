<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Teacher Login</title>
  <style>
    body { font-family: system-ui, sans-serif; max-width: 720px; margin: 40px auto; }
    input, button { font-size: 16px; padding: 10px; width: 100%; }
    .row { margin: 10px 0; }
    .err { color: #b00020; white-space: pre-wrap; margin-top: 10px; }
  </style>
</head>
<body>
  <h1>Teacher Login</h1>

  <div class="row">
    <input id="email" placeholder="Email" />
  </div>
  <div class="row">
    <input id="password" placeholder="Password" type="password" />
  </div>
  <div class="row">
    <button id="btnLogin">Login</button>
  </div>
  <div class="row">
    <a href="/ui/teacher_register.html">Create account</a>
  </div>

  <div id="msg" class="err"></div>

  <script>
    const msg = document.getElementById("msg");

    document.getElementById("btnLogin").onclick = async () => {
      msg.textContent = "";
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value;

      if (!email || !password) {
        msg.textContent = "Please enter email + password.";
        return;
      }

      const body = new URLSearchParams();
      body.set("username", email);
      body.set("password", password);

      const r = await fetch("/auth/token", {
        method: "POST",
        headers: {"Content-Type": "application/x-www-form-urlencoded"},
        body
      });

      const j = await r.json().catch(() => ({}));
      if (!r.ok) {
        msg.textContent = j.detail || `Login failed (HTTP ${r.status})`;
        return;
      }

      localStorage.setItem("teacher_token", j.access_token);
      window.location.href = "/ui/teacher_labs.html";
    };
  </script>
</body>
</html>